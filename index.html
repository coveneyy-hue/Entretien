<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Entretien</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    body { margin: 0; background: #f6f7f9; color: #111; }
    header { padding: 14px 16px; background: #fff; position: sticky; top: 0; border-bottom: 1px solid #e6e8ee; z-index: 3; }
    h1 { margin: 0; font-size: 18px; }
    main { padding: 12px; max-width: 980px; margin: 0 auto; padding-bottom: 86px; }

    .toolbar { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; align-items: center; }
    button { border: 1px solid #d7dbe6; background: #fff; border-radius: 10px; padding: 10px 12px; font-weight: 800; }
    button.primary { background: #111; color: #fff; border-color: #111; }
    button.danger { border-color: #ffced0; }
    button:active { transform: scale(0.99); }
    button[disabled]{ opacity:.55; }

    .pill { font-size: 12px; border: 1px solid #e6e8ee; border-radius: 999px; padding: 6px 10px; background: #fff; }

    .list { display: grid; gap: 10px; margin-top: 12px; }
    .row {
      display: grid;
      grid-template-columns: 38px 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 10px;
      border: 1px solid #eef0f6;
      border-radius: 12px;
      background: #fff;
    }

    .desc { font-weight: 900; line-height: 1.1; }
    .meta { margin-top: 6px; font-size: 12px; color: #333; }
    .k { color: #555; font-weight: 800; }
    .v { font-weight: 950; }

    .status { font-size: 12px; font-weight: 900; padding: 6px 8px; border-radius: 999px; border: 1px solid #eee; }
    .due { color: #b00020; border-color: #ffd3da; background: #fff5f6; }
    .ok { color: #116b2f; border-color: #cfe9d8; background: #f3fbf6; }
  </style>
</head>
<body>

<header>
  <h1>Entretien</h1>
</header>

<main>
  <div class="list" id="list"></div>
</main>

<script>
(() => {
  const pad2 = n => String(n).padStart(2,"0");
  const toYMD = d => `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
  const startOfToday = () => { const d = new Date(); d.setHours(0,0,0,0); return d; };
  const addDays = (d,n) => new Date(d.getTime() + n*86400000);

  const items = [
    { id:1, description:"Changer filtre fournaise", dateDebut:"2024-12-01", intervalJours:90 },
    { id:2, description:"Nettoyer échangeur d’air", dateDebut: toYMD(startOfToday()), intervalJours:0 }
  ];

  function render() {
    const todayYMD = toYMD(startOfToday());
    const list = document.querySelector("#list");
    list.innerHTML = "";

    items.forEach(item => {
      const ref = new Date(item.dateDebut);
      const dueDate = addDays(ref, Number(item.intervalJours));
      const dueYMD = toYMD(dueDate);

      const prochaineLabel = (dueYMD === todayYMD) ? "Aujourd’hui" : dueYMD;

      const row = document.createElement("div");
      row.className = "row";
      row.innerHTML = `
        <div></div>
        <div>
          <div class="desc">${item.description}</div>
          <div class="meta">
            <span class="k">Prochaine:</span>
            <span class="v">${prochaineLabel}</span>
          </div>
        </div>
        <div class="status ok">OK</div>
      `;
      list.appendChild(row);
    });
  }

  render();
})();
</script>

</body>
</html>
